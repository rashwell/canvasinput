var CanvasInput=function(){function CanvasInput(options){if(this._canvas=null,this._renderCanvas=null,this._shadowCanvas=null,this._ctx=null,this._renderCtx=null,this._shadowCtx=null,this._x=0,this._y=0,this._extraX=0,this._extraY=0,this._fontSize=14,this._fontFamily="Arial",this._fontColor="#000",this._placeHolderColor="#bfbebd",this._fontWeight="normal",this._fontStyle="normal",this._readonly=!1,this._maxlength=null,this._width=150,this._height=14,this._padding=5,this._borderWidth=1,this._borderColor="#959595",this._borderRadius=3,this._backgroundImage="",this._boxShadow="1px 1px 0px rgba(255, 255, 255, 1)",this._boxShadowObj=null,this._innerShadow="0px 0px 4px rgba(0, 0, 0, 0.4)",this._selectionColor="rgba(179, 212, 253, 0.8)",this._placeHolder="",this._value="",this._cursor=!1,this._cursorPos=0,this._hasFocus=!1,this._selection=[0,0],this._wasOver=!1,this._mouseDown=!1,this._renderType="2d",this.shadowL=0,this.shadowR=0,this.shadowT=0,this.shadowB=0,this.shadowH=0,this.shadowW=0,this.outerW=0,this.outerH=0,this.focus=function(pos){if(!this._hasFocus){this._onfocus(this);for(var i=0;i<CanvasInput.inputs.length;i++)CanvasInput.inputs[i]._hasFocus&&CanvasInput.inputs[i].blur()}if(this._selectionUpdated?delete this._selectionUpdated:this._selection=[0,0],this._hasFocus=!0,this._readonly)return void(this._hiddenInput.readOnly=!0);this._hiddenInput.readOnly=!1,this._cursorPos="number"==typeof pos?pos:this._clipText().length,this._placeHolder===this._value&&(this._value="",this._hiddenInput.value=""),this._cursor=!0,this._cursorInterval&&clearInterval(this._cursorInterval);var _this=this;this._cursorInterval=setInterval(function(){_this._cursor=!_this._cursor,_this.render()},500);var hasSelection=this._selection[0]>0||this._selection[1]>0;return this._hiddenInput.focus(),this._hiddenInput.selectionStart=hasSelection?this._selection[0]:this._cursorPos,this._hiddenInput.selectionEnd=hasSelection?this._selection[1]:this._cursorPos,this.render()},this.blur=function(cinput){var _this=cinput||this;return _this._onblur(_this),_this._cursorInterval&&clearInterval(_this._cursorInterval),_this._hasFocus=!1,_this._cursor=!1,_this._selection=[0,0],_this._hiddenInput.blur(),""===_this._value&&(_this._value=_this._placeHolder),this.render()},this.keydown=function(e,_this){var keyCode=e.which;e.shiftKey;if(!this._readonly&&this._hasFocus){if(this._onkeydown(e,this),65===keyCode&&(e.ctrlKey||e.metaKey))return this.selectText(),e.preventDefault(),this.render();if(17===keyCode||e.metaKey||e.ctrlKey)return this;if(13===keyCode)e.preventDefault(),this._onsubmit(e,this);else if(9===keyCode&&(e.preventDefault(),CanvasInput.inputs.length>1)){var next=CanvasInput.inputs[this._inputsIndex+1]?this._inputsIndex+1:0;this.blur(),setTimeout(function(){CanvasInput.inputs[next].focus()},10)}return this._value=this._hiddenInput.value,this._cursorPos=this._hiddenInput.selectionStart,this._selection=[0,0],this.render()}},this.click=function(e,_this){var mouse=_this._mousePos(e),x=mouse.x,y=mouse.y;return _this._endSelection?(delete _this._endSelection,void delete _this._selectionUpdated):_this._canvas&&_this._overInput(x,y)||!_this._canvas?_this._mouseDown?(_this._mouseDown=!1,_this.click(e,_this),_this.focus(_this._clickPos(x,y))):void 0:_this.blur()},this.mousemove=function(e,_this){var mouse=_this._mousePos(e),x=mouse.x,y=mouse.y,isOver=_this._overInput(x,y);if(isOver&&_this._canvas?(_this._canvas.style.cursor="text",_this._wasOver=!0):_this._wasOver&&_this._canvas&&(_this._canvas.style.cursor="default",_this._wasOver=!1),_this._hasFocus&&_this._selectionStart>=0){var curPos=_this._clickPos(x,y),start=Math.min(_this._selectionStart,curPos),end=Math.max(_this._selectionStart,curPos);if(!isOver)return _this._selectionUpdated=!0,_this._endSelection=!0,delete _this._selectionStart,void _this.render();(_this._selection[0]!==start||_this._selection[1]!==end)&&(_this._selection=[start,end],_this.render())}},this.mousedown=function(e,_this){var mouse=_this._mousePos(e),x=mouse.x,y=mouse.y,isOver=_this._overInput(x,y);_this._mouseDown=isOver,_this._hasFocus&&isOver&&(_this._selectionStart=_this._clickPos(x,y))},this.mouseup=function(e,_this){var mouse=_this._mousePos(e),x=mouse.x,y=mouse.y,isSelection=_this._clickPos(x,y)!==_this._selectionStart;_this._hasFocus&&_this._selectionStart>=0&&_this._overInput(x,y)&&isSelection?(_this._selectionUpdated=!0,delete _this._selectionStart,_this.render()):delete _this._selectionStart,_this.click(e,_this)},this.selectText=function(range){var _range=range||[0,this._value.length];return setTimeout(function(){this._selection=[_range[0],_range[1]],this._hiddenInput.selectionStart=_range[0],this._hiddenInput.selectionEnd=_range[1],this.render()},1),this},this.destroy=function(){var index=CanvasInput.inputs.indexOf(this);index&&CanvasInput.inputs.splice(index,1),this._hasFocus&&this.blur(),document.body.removeChild(this._hiddenInput),this._renderCanvas=null,this._shadowCanvas=null,this._renderCtx=null},this._textWidth=function(text){var ctx=this._renderCtx;return ctx.font=this._fontStyle+" "+this._fontWeight+" "+this._fontSize+"px "+this._fontFamily,ctx.textAlign="left",ctx.measureText(text).width},this._clipText=function(value){value="undefined"==typeof value?this._value:value;var textWidth=this._textWidth(value),fillPer=textWidth/(this._width-this._padding),text=fillPer>1?value.substr(-1*Math.floor(value.length/fillPer)):value;return text+""},this._overInput=function(x,y){var xLeft=x>=this._x+this._extraX,xRight=x<=this._x+this._extraX+this._width+2*this._padding,yTop=y>=this._y+this._extraY,yBottom=y<=this._y+this._extraY+this._height+2*this._padding;return xLeft&&xRight&&yTop&&yBottom},this._clickPos=function(x,y){var value=this._value;this._value===this._placeHolder&&(value="");var text=this._clipText(value),totalW=0,pos=text.length;if(x-(this._x+this._extraX)<this._textWidth(text))for(var i=0;i<text.length;i++)if(totalW+=this._textWidth(text[i]),totalW>=x-(this._x+this._extraX)){pos=i;break}return pos},this._drawTextBox=function(fn){var ctx=this._renderCtx,w=this.outerW,h=this.outerH,br=this._borderRadius,bw=this._borderWidth,sw=this.shadowW,sh=this.shadowH;if(""===this._backgroundImage)ctx.fillStyle=this._backgroundColor,this._roundedRect(ctx,bw+this.shadowL,bw+this.shadowT,w-2*bw-sw,h-2*bw-sh,br),ctx.fill(),fn();else{var img=new Image;img.src=this._backgroundImage,img.onload=function(){ctx.drawImage(img,0,0,img.width,img.height,bw+this.shadowL,bw+this.shadowT,w,h),fn()}}},this._roundedRect=function(ctx,x,y,w,h,r){2*r>w&&(r=w/2),2*r>h&&(r=h/2),ctx.beginPath(),ctx.moveTo(x+r,y),ctx.lineTo(x+w-r,y),ctx.quadraticCurveTo(x+w,y,x+w,y+r),ctx.lineTo(x+w,y+h-r),ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h),ctx.lineTo(x+r,y+h),ctx.quadraticCurveTo(x,y+h,x,y+h-r),ctx.lineTo(x,y+r),ctx.quadraticCurveTo(x,y,x+r,y),ctx.closePath()},this._clearSelection=function(){if(this._selection[1]>0){var start=this._selection[0],end=this._selection[1];return this._value=this._value.substr(0,start)+this._value.substr(end),this._cursorPos=start,this._cursorPos=this._cursorPos<0?0:this._cursorPos,this._selection=[0,0],!0}return!1},this._calcWH=function(){this.outerW=this._width+2*this._padding+2*this._borderWidth+this.shadowW,this.outerH=this._height+2*this._padding+2*this._borderWidth+this.shadowH},this._updateCanvasWH=function(){var oldW=this._renderCanvas.width,oldH=this._renderCanvas.height;this._renderCanvas.setAttribute("width",this.outerW),this._renderCanvas.setAttribute("height",this.outerH),this._shadowCanvas.setAttribute("width",this._width+2*this._padding),this._shadowCanvas.setAttribute("height",this._height+2*this._padding),this._ctx&&"2d"===this._renderType&&this._ctx.clearRect(this._x,this._y,oldW,oldH)},this.render=function(){var ctx=this._renderCtx,w=this.outerW,h=this.outerH,br=this._borderRadius,bw=this._borderWidth,sw=this.shadowW,sh=this.shadowH;if(ctx){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),ctx.shadowOffsetX=this._boxShadow.x,ctx.shadowOffsetY=this._boxShadow.y,ctx.shadowBlur=this._boxShadow.blur,ctx.shadowColor=this._boxShadow.color,this._borderWidth>0&&(ctx.fillStyle=this._borderColor,this._roundedRect(ctx,this.shadowL,this.shadowT,w-sw,h-sh,br),ctx.fill(),ctx.shadowOffsetX=0,ctx.shadowOffsetY=0,ctx.shadowBlur=0);var _this=this;this._drawTextBox(function(){ctx.shadowOffsetX=0,ctx.shadowOffsetY=0,ctx.shadowBlur=0;var text=_this._clipText(),paddingBorder=_this._padding+_this._borderWidth+_this.shadowT;if(_this._selection[1]>0){var selectOffset=_this._textWidth(text.substring(0,_this._selection[0])),selectWidth=_this._textWidth(text.substring(_this._selection[0],_this._selection[1]));ctx.fillStyle=_this._selectionColor,ctx.fillRect(paddingBorder+selectOffset,paddingBorder,selectWidth,_this._height)}if(_this._cursor){var cursorOffset=_this._textWidth(text.substring(0,_this._cursorPos));ctx.fillStyle=_this._fontColor,ctx.fillRect(paddingBorder+cursorOffset,paddingBorder,1,_this._height)}var textX=_this._padding+_this._borderWidth+_this.shadowL,textY=Math.round(paddingBorder+_this._height/2);text=""===text&&_this._placeHolder?_this._placeHolder:text,ctx.fillStyle=""!==_this._value&&_this._value!==_this._placeHolder?_this._fontColor:_this._placeHolderColor,ctx.font=_this._fontStyle+" "+_this._fontWeight+" "+_this._fontSize+"px "+_this._fontFamily,ctx.textAlign="left",ctx.textBaseline="middle",ctx.fillText(text,textX,textY);var innerShadow=_this._innerShadow.split("px "),isOffsetX="none"===_this._innerShadow?0:parseInt(innerShadow[0],10),isOffsetY="none"===_this._innerShadow?0:parseInt(innerShadow[1],10),isBlur="none"===_this._innerShadow?0:parseInt(innerShadow[2],10),isColor="none"===_this._innerShadow?"":innerShadow[3];if(isBlur>0){var shadowCtx=_this._shadowCtx,scw=shadowCtx.canvas.width,sch=shadowCtx.canvas.height;shadowCtx.clearRect(0,0,scw,sch),shadowCtx.shadowBlur=isBlur,shadowCtx.shadowColor=isColor,shadowCtx.shadowOffsetX=0,shadowCtx.shadowOffsetY=isOffsetY,shadowCtx.fillRect(-1*w,-100,3*w,100),shadowCtx.shadowOffsetX=isOffsetX,shadowCtx.shadowOffsetY=0,shadowCtx.fillRect(scw,-1*h,100,3*h),shadowCtx.shadowOffsetX=0,shadowCtx.shadowOffsetY=isOffsetY,shadowCtx.fillRect(-1*w,sch,3*w,100),shadowCtx.shadowOffsetX=isOffsetX,shadowCtx.shadowOffsetY=0,shadowCtx.fillRect(-100,-1*h,100,3*h),_this._roundedRect(ctx,bw+_this.shadowL,bw+_this.shadowT,w-2*bw-sw,h-2*bw-sh,br),ctx.clip(),ctx.drawImage(_this._shadowCanvas,0,0,scw,sch,bw+_this.shadowL,bw+_this.shadowT,scw,sch)}return _this._ctx&&(_this._ctx.clearRect(_this._x,_this._y,ctx.canvas.width,ctx.canvas.height),_this._ctx.drawImage(_this._renderCanvas,_this._x,_this._y)),_this})}},options.canvas&&(this._canvas=options.canvas),this._canvas)if("2d"===this._renderType)this._ctx=this._canvas.getContext("2d");else if("WebGLRenderingContext"in window)this._ctx=this._canvas.getContext("2d"),this._renderType="2d";else{var testctx=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl");void 0!==testctx?(this._ctx=this._canvas.getContext("2d"),this._renderType="2d"):this._ctx=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl")}if(options.x&&(this._x=options.x),options.y&&(this._y=options.y),options.extraX&&(this._extraX=options.extraX),options.extraY&&(this._extraY=options.extraY),options.fontSize&&(this._fontSize=options.fontSize),options.fontFamily&&(this._fontFamily=options.fontFamily),options.fontColor&&(this._fontColor=options.fontColor),options.placeHolderColor&&(this._placeHolderColor=options.placeHolderColor),options.fontWeight&&(this._fontWeight=options.fontWeight),options.fontStyle&&(this._fontStyle=options.fontStyle),options.readonly&&(this._readonly=options.readonly),options.maxlength&&(this._maxlength=options.maxlength),options.width&&(this._width=options.width),options.height&&(this._height=options.height),options.padding&&options.padding>=0&&(this._padding=options.padding),options.borderWidth&&options.borderWidth>=0&&(this._borderWidth=options.borderWidth),options.borderColor&&(this._borderColor=options.borderColor),options.borderRadius&&options.borderRadius>=0&&(this._borderRadius=options.borderRadius),options.backgroundImage&&(this._backgroundImage=options.backgroundImage),options.boxShadow&&(this._boxShadow=options.boxShadow),options.innerShadow&&(this._innerShadow=options.innerShadow),options.selectionColor&&(this._selectionColor=options.selectionColor),options.placeHolder&&(this._placeHolder=options.placeHolder),options.value&&(this._value=(options.value||this._placeHolder)+""),options.onsubmit?this._onsubmit=options.onsubmit:this._onsubmit=function(){},options.onkeydown?this._onkeydown=options.onkeydown:this._onkeydown=function(){},options.onkeyup?this._onkeyup=options.onkeyup:this._onkeyup=function(){},options.onfocus?this._onfocus=options.onfocus:this._onfocus=function(){},options.onblur?this._onblur=options.onblur:this._onblur=function(){},this.boxShadow(this._boxShadow,!0),this._calcWH(),this._renderCanvas=document.createElement("canvas"),this._renderCanvas.setAttribute("width",this.outerW.toString()),this._renderCanvas.setAttribute("height",this.outerH.toString()),"2d"===this._renderType?this._renderCtx=this._renderCanvas.getContext("2d"):this._renderCtx=this._renderCanvas.getContext("webgl")||this._renderCanvas.getContext("experimental-webgl"),this._shadowCanvas=document.createElement("canvas"),this._shadowCanvas.setAttribute("width",(this._width+2*this._padding).toString()),this._shadowCanvas.setAttribute("height",(this._height+2*this._padding).toString()),"2d"===this._renderType?this._shadowCtx=this._shadowCanvas.getContext("2d"):this._shadowCtx=this._shadowCanvas.getContext("webgl")||this._shadowCanvas.getContext("experimental-webgl"),"undefined"!=typeof options.backgroundGradient?(this._backgroundColor=this._renderCtx.createLinearGradient(0,0,0,this.outerH),this._backgroundColor.addColorStop(0,options.backgroundGradient[0]),this._backgroundColor.addColorStop(1,options.backgroundGradient[1])):this._backgroundColor=options.backgroundColor||"#fff",this._canvas){var _this=this;this._canvas.addEventListener("mousemove",function(ev){var e=ev||window.event;_this.mousemove(e,_this)},!1),this._canvas.addEventListener("mousedown",function(ev){var e=ev||window.event;_this.mousedown(e,_this)},!1),this._canvas.addEventListener("mouseup",function(ev){var e=ev||window.event;_this.mouseup(e,_this)},!1)}var _this=this;window.addEventListener("mouseup",function(ev){ev||window.event;_this._hasFocus&&!_this._mouseDown&&_this.blur()},!0),this._hiddenInput=document.createElement("input"),this._hiddenInput.type="text",this._hiddenInput.style.position="absolute",this._hiddenInput.style.opacity="0",this._hiddenInput.style.pointerEvents="none",this._hiddenInput.style.left=this._x+this._extraX+(this._canvas?this._canvas.offsetLeft:0)+"px",this._hiddenInput.style.top=this._y+this._extraY+(this._canvas?this._canvas.offsetTop:0)+"px",this._hiddenInput.style.width=this._width+"px",this._hiddenInput.style.height=this._height+"px",this._hiddenInput.style.zIndex="0",this._maxlength&&(this._hiddenInput.maxLength=this._maxlength),document.body.appendChild(this._hiddenInput),this._hiddenInput.value=this._value;var _this=this;this._hiddenInput.addEventListener("keydown",function(ev){var e=ev||window.event;_this._hasFocus&&_this.keydown(e,_this)}),this._hiddenInput.addEventListener("keyup",function(ev){var e=ev||window.event;_this._value=_this._hiddenInput.value,_this._cursorPos=_this._hiddenInput.selectionStart,_this.render(),_this._hasFocus&&_this._onkeyup(e,_this)}),CanvasInput.inputs.push(this),CanvasInput._inputsIndex=CanvasInput.inputs.length-1,this.render()}return Object.defineProperty(CanvasInput.prototype,"canvas",{get:function(){return this._canvas},set:function(value){if(void 0!==typeof value){if(this._canvas=value,"WebGLRenderingContext"in window)this._ctx=this._canvas.getContext("2d"),this._renderType="2d";else{var testctx=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl");void 0!==testctx?(this._ctx=this._canvas.getContext("2d"),this._renderType="2d"):this._ctx=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl")}this.render()}},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"x",{get:function(){return this._x},set:function(value){"undefined"!=typeof value&&(this._x=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"y",{get:function(){return this._y},set:function(value){"undefined"!=typeof value&&(this._y=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"extraX",{get:function(){return this._extraX},set:function(value){"undefined"!=typeof value&&(this._extraX=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"extraY",{get:function(){return this._extraY},set:function(value){"undefined"!=typeof value&&(this._extraY=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"fontSize",{get:function(){return this._fontSize},set:function(value){"undefined"!=typeof value&&(this._fontSize=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(value){"undefined"!=typeof value&&(this._fontFamily=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"fontColor",{get:function(){return this._fontColor},set:function(value){"undefined"!=typeof value&&(this._fontColor=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"placeHolderColor",{get:function(){return this._placeHolderColor},set:function(value){"undefined"!=typeof value&&(this._placeHolderColor=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(value){"undefined"!=typeof value&&(this._fontWeight=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(value){"undefined"!=typeof value&&(this._fontStyle=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"width",{get:function(){return this._width},set:function(value){"undefined"!=typeof value&&(this._width=value,this._calcWH(),this._updateCanvasWH(),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"height",{get:function(){return this._height},set:function(value){"undefined"!=typeof value&&(this._height=value,this._calcWH(),this._updateCanvasWH(),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"padding",{get:function(){return this._padding},set:function(value){"undefined"!=typeof value&&(this._padding=value,this._calcWH(),this._updateCanvasWH(),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"borderWidth",{get:function(){return this._borderWidth},set:function(value){"undefined"!=typeof value&&(this._borderWidth=value,this._calcWH(),this._updateCanvasWH(),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"borderColor",{get:function(){return this._borderColor},set:function(value){"undefined"!=typeof value&&(this._borderColor=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"borderRadius",{get:function(){return this._borderRadius},set:function(value){"undefined"!=typeof value&&(this._borderRadius=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(value){"undefined"!=typeof value&&(this._backgroundColor=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"backgroundGradient",{get:function(){return this._backgroundColor},set:function(value){"undefined"!=typeof value&&(this._backgroundColor=this._renderCtx.createLinearGradient(0,0,0,this.outerH),this._backgroundColor.addColorStop(0,value[0]),this._backgroundColor.addColorStop(1,value[1]),this.render())},enumerable:!0,configurable:!0}),CanvasInput.prototype.boxShadow=function(data,doReturn){if("undefined"==typeof data)return this._boxShadow;var boxShadow=data.split("px ");return this._boxShadowObj={x:"none"===this._boxShadow?0:parseInt(boxShadow[0],10),y:"none"===this._boxShadow?0:parseInt(boxShadow[1],10),blur:"none"===this._boxShadow?0:parseInt(boxShadow[2],10),color:"none"===this._boxShadow?"":boxShadow[3]},this._boxShadowObj.x<0?(this.shadowL=Math.abs(this._boxShadowObj.x)+this._boxShadowObj.blur,this.shadowR=this._boxShadowObj.blur+this._boxShadowObj.x):(this.shadowL=Math.abs(this._boxShadowObj.blur-this._boxShadowObj.x),this.shadowR=this._boxShadowObj.blur+this._boxShadowObj.x),this._boxShadowObj.y<0?(this.shadowT=Math.abs(this._boxShadowObj.y)+this._boxShadowObj.blur,this.shadowB=this._boxShadowObj.blur+this._boxShadowObj.y):(this.shadowT=Math.abs(this._boxShadowObj.blur-this._boxShadowObj.y),this.shadowB=this._boxShadowObj.blur+this._boxShadowObj.y),this.shadowW=this.shadowL+this.shadowR,this.shadowH=this.shadowT+this.shadowB,this._calcWH(),doReturn?void 0:(this._updateCanvasWH(),this.render())},Object.defineProperty(CanvasInput.prototype,"innerShadow",{get:function(){return this._innerShadow},set:function(value){"undefined"!=typeof value&&(this._innerShadow=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"selectionColor",{get:function(){return this._selectionColor},set:function(value){"undefined"!=typeof value&&(this._selectionColor=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"placeHolder",{get:function(){return this._placeHolder},set:function(value){"undefined"!=typeof value&&(this._placeHolder=value,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"value",{get:function(){return this._value===this._placeHolder?"":this._value},set:function(data){"undefined"!=typeof data&&(this._value=data+"",this._hiddenInput.value=data+"",this._cursorPos=this._clipText().length,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"onsubmit",{get:function(){return this._onsubmit},set:function(fn){"undefined"!=typeof fn&&(this._onsubmit=fn)},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"onkeydown",{get:function(){return this._onkeydown},set:function(fn){"undefined"!=typeof fn&&(this._onkeydown=fn)},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"onkeyup",{get:function(){return this._onkeyup},set:function(fn){"undefined"!=typeof fn&&(this._onkeyup=fn)},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasInput.prototype,"renderCanvas",{get:function(){return this._renderCanvas},enumerable:!0,configurable:!0}),CanvasInput.prototype._mousePos=function(e){var elm=e.target,style=document.defaultView.getComputedStyle(elm,void 0),paddingLeft=parseInt(style.paddingLeft,10)||0,paddingTop=parseInt(style.paddingLeft,10)||0,borderLeft=parseInt(style.borderLeftWidth,10)||0,borderTop=parseInt(style.borderLeftWidth,10)||0,offsetX=0,offsetY=0,htmlTop=0,htmlLeft=0,htmlrec=document.body.getBoundingClientRect();if(htmlTop=htmlrec.top||0,htmlLeft=htmlrec.left||0,"undefined"!=typeof elm.offsetParent)do offsetX+=elm.offsetLeft,offsetY+=elm.offsetTop;while(elm=elm.offsetParent);return offsetX+=paddingLeft+borderLeft+htmlLeft,offsetY+=paddingTop+borderTop+htmlTop,{x:e.pageX-offsetX,y:e.pageY-offsetY}},CanvasInput.inputs=[],CanvasInput._inputsIndex=0,CanvasInput}();